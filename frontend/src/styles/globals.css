@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  :root {
    --background: 250 250 249;
    --foreground: 28 25 23;
    --card: 255 255 255;
    --card-foreground: 28 25 23;
    --popover: 255 255 255;
    --popover-foreground: 28 25 23;
    --primary: 28 25 23;
    --primary-foreground: 250 250 249;
    --secondary: 245 245 244;
    --secondary-foreground: 28 25 23;
    --muted: 245 245 244;
    --muted-foreground: 120 113 108;
    --accent: 245 245 244;
    --accent-foreground: 28 25 23;
    --destructive: 239 68 68;
    --destructive-foreground: 250 250 249;
    --border: 231 229 228;
    --input: 231 229 228;
    --ring: 28 25 23;
    --radius: 0.75rem;
  }

  .dark {
    --background: 23 23 23;
    --foreground: 250 250 249;
    --card: 38 38 38;
    --card-foreground: 250 250 249;
    --popover: 38 38 38;
    --popover-foreground: 250 250 249;
    --primary: 250 250 249;
    --primary-foreground: 23 23 23;
    --secondary: 64 64 64;
    --secondary-foreground: 250 250 249;
    --muted: 64 64 64;
    --muted-foreground: 163 163 163;
    --accent: 64 64 64;
    --accent-foreground: 250 250 249;
    --destructive: 239 68 68;
    --destructive-foreground: 250 250 249;
    --border: 64 64 64;
    --input: 64 64 64;
    --ring: 212 212 212;
  }

  * {
    border-color: rgb(var(--border));
  }

  body {
    background-color: rgb(var(--background));
    color: rgb(var(--foreground));
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  html {
    /* Keep layout width stable when pages have different heights. */
    scrollbar-gutter: stable;
    overflow-y: scroll;
  }

  /* Global focus-visible styles for accessibility */
  a:focus-visible,
  button:focus-visible,
  [role="button"]:focus-visible,
  [tabindex]:focus-visible {
    outline: 2px solid rgb(var(--ring));
    outline-offset: 2px;
  }

  /* Remove default outline for mouse users, keep for keyboard */
  :focus:not(:focus-visible) {
    outline: none;
  }

  /* Override Chrome/Safari autofill yellow background */
  input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus,
  input:-webkit-autofill:active,
  textarea:-webkit-autofill,
  textarea:-webkit-autofill:hover,
  textarea:-webkit-autofill:focus,
  textarea:-webkit-autofill:active,
  select:-webkit-autofill,
  select:-webkit-autofill:hover,
  select:-webkit-autofill:focus,
  select:-webkit-autofill:active {
    -webkit-box-shadow: 0 0 0 1000px rgb(var(--card)) inset !important;
    -webkit-text-fill-color: rgb(var(--foreground)) !important;
    background-color: rgb(var(--card)) !important;
    background-image: none !important;
    color: rgb(var(--foreground)) !important;
    transition: background-color 5000s ease-in-out 0s, color 5000s ease-in-out 0s;
  }

  /* Scrollbar - Light mode */
  * {
    scrollbar-width: thin;
    scrollbar-color: #d4d4d4 transparent;
  }

  *::-webkit-scrollbar {
    width: 6px;
    height: 6px;
  }

  *::-webkit-scrollbar-track {
    background: transparent;
  }

  *::-webkit-scrollbar-thumb {
    background-color: #d4d4d4;
    border-radius: 3px;
  }

  *::-webkit-scrollbar-thumb:hover {
    background-color: #a3a3a3;
  }

  /* Scrollbar - Dark mode */
  .dark * {
    scrollbar-color: #525252 transparent;
  }

  .dark *::-webkit-scrollbar-thumb {
    background-color: #525252;
  }

  .dark *::-webkit-scrollbar-thumb:hover {
    background-color: #737373;
  }
}

@layer utilities {
  /* RTL Support - Logical properties for bidirectional layouts */
  /* These utilities automatically flip in RTL mode */

  /* Margin utilities using logical properties */
  .ms-auto { margin-inline-start: auto; }
  .me-auto { margin-inline-end: auto; }
  .ms-0 { margin-inline-start: 0; }
  .me-0 { margin-inline-end: 0; }
  .ms-1 { margin-inline-start: 0.25rem; }
  .me-1 { margin-inline-end: 0.25rem; }
  .ms-2 { margin-inline-start: 0.5rem; }
  .me-2 { margin-inline-end: 0.5rem; }
  .ms-3 { margin-inline-start: 0.75rem; }
  .me-3 { margin-inline-end: 0.75rem; }
  .ms-4 { margin-inline-start: 1rem; }
  .me-4 { margin-inline-end: 1rem; }

  /* Padding utilities using logical properties */
  .ps-0 { padding-inline-start: 0; }
  .pe-0 { padding-inline-end: 0; }
  .ps-1 { padding-inline-start: 0.25rem; }
  .pe-1 { padding-inline-end: 0.25rem; }
  .ps-2 { padding-inline-start: 0.5rem; }
  .pe-2 { padding-inline-end: 0.5rem; }
  .ps-3 { padding-inline-start: 0.75rem; }
  .pe-3 { padding-inline-end: 0.75rem; }
  .ps-4 { padding-inline-start: 1rem; }
  .pe-4 { padding-inline-end: 1rem; }

  /* Border radius utilities using logical properties */
  .rounded-s { border-start-start-radius: var(--radius); border-end-start-radius: var(--radius); }
  .rounded-e { border-start-end-radius: var(--radius); border-end-end-radius: var(--radius); }
  .rounded-ss { border-start-start-radius: var(--radius); }
  .rounded-se { border-start-end-radius: var(--radius); }
  .rounded-es { border-end-start-radius: var(--radius); }
  .rounded-ee { border-end-end-radius: var(--radius); }

  /* Border utilities using logical properties */
  .border-s { border-inline-start-width: 1px; }
  .border-e { border-inline-end-width: 1px; }
  .border-s-0 { border-inline-start-width: 0; }
  .border-e-0 { border-inline-end-width: 0; }
  .border-s-2 { border-inline-start-width: 2px; }
  .border-e-2 { border-inline-end-width: 2px; }

  /* Positioning utilities using logical properties */
  .start-0 { inset-inline-start: 0; }
  .end-0 { inset-inline-end: 0; }
  .start-auto { inset-inline-start: auto; }
  .end-auto { inset-inline-end: auto; }
  .start-1 { inset-inline-start: 0.25rem; }
  .end-1 { inset-inline-end: 0.25rem; }
  .start-2 { inset-inline-start: 0.5rem; }
  .end-2 { inset-inline-end: 0.5rem; }
  .start-3 { inset-inline-start: 0.75rem; }
  .end-3 { inset-inline-end: 0.75rem; }
  .start-4 { inset-inline-start: 1rem; }
  .end-4 { inset-inline-end: 1rem; }

  /* Text alignment using logical properties */
  .text-start { text-align: start; }
  .text-end { text-align: end; }

  /* Float utilities using logical properties - RTL aware */
  .float-start { float: inline-start; }
  .float-end { float: inline-end; }

  /* RTL-specific overrides */
  [dir="rtl"] .rtl\:rotate-180 {
    transform: rotate(180deg);
  }

  [dir="rtl"] .rtl\:space-x-reverse > :not([hidden]) ~ :not([hidden]) {
    --tw-space-x-reverse: 1;
  }

  /* Safe area insets for notch devices (iPhone X, etc.) */
  .safe-area-inset {
    padding-top: env(safe-area-inset-top);
    padding-right: env(safe-area-inset-right);
    padding-bottom: env(safe-area-inset-bottom);
    padding-left: env(safe-area-inset-left);
  }

  .safe-area-pt {
    padding-top: env(safe-area-inset-top);
  }

  .safe-area-pb {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-area-pl {
    padding-left: env(safe-area-inset-left);
  }

  .safe-area-pr {
    padding-right: env(safe-area-inset-right);
  }

  /* Touch-manipulation for better mobile scrolling and touch response */
  .touch-manipulation {
    touch-action: manipulation;
  }

  /* Minimum touch target sizes (44x44px per Apple HIG / 48x48px per Material Design) */
  .touch-target {
    min-height: 44px;
    min-width: 44px;
  }

  .touch-target-lg {
    min-height: 48px;
    min-width: 48px;
  }

  /* Prevent text selection on interactive elements (useful for buttons) */
  .select-none-touch {
    -webkit-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
  }

  /* Smooth momentum scrolling for iOS */
  .scroll-smooth-touch {
    -webkit-overflow-scrolling: touch;
  }

  /* Hide scrollbar but keep functionality (useful for mobile carousels) */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* Active/pressed state for touch devices */
  @media (hover: none) and (pointer: coarse) {
    .touch\:opacity-100 {
      opacity: 1;
    }

    .touch\:bg-stone-100:active {
      background-color: rgb(245 245 244);
    }
  }

  /* Shimmer loading animation for skeletons and image placeholders */
  .animate-shimmer {
    background: linear-gradient(
      90deg,
      rgb(var(--muted)) 0%,
      rgb(var(--muted) / 0.5) 50%,
      rgb(var(--muted)) 100%
    );
    background-size: 200% 100%;
    animation: shimmer 1.5s ease-in-out infinite;
  }

  @keyframes shimmer {
    0% { background-position: -200% 0; }
    100% { background-position: 200% 0; }
  }

  /* Fade in animation - stable and smooth */
  .animate-fade-in {
    animation: fadeIn 0.3s ease-out forwards;
    will-change: transform, opacity;
  }

  @keyframes fadeIn {
    from {
      opacity: 0;
      transform: translateY(8px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-sequence-header-view-in {
    animation: sequence-header-view-in 220ms cubic-bezier(0.22, 1, 0.36, 1) both;
    will-change: transform, opacity;
  }

  @keyframes sequence-header-view-in {
    from {
      opacity: 0;
      transform: translateY(6px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-sequence-header-edit-in {
    animation: sequence-header-edit-in 240ms cubic-bezier(0.22, 1, 0.36, 1) both;
    will-change: transform, opacity;
  }

  @keyframes sequence-header-edit-in {
    from {
      opacity: 0;
      transform: translateY(8px) scale(0.995);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .animate-sequence-header-actions-in {
    animation: sequence-header-actions-in 200ms ease-out both;
    will-change: transform, opacity;
  }

  @keyframes sequence-header-actions-in {
    from {
      opacity: 0;
      transform: translateX(6px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  /* Subtle pulse animation for decorative icons (GPU-friendly CSS alternative to Framer Motion infinite) */
  .animate-pulse-subtle {
    animation: pulse-subtle 3s ease-in-out infinite;
  }

  @keyframes pulse-subtle {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.1); }
  }

  .animate-heartbeat {
    animation: heartbeat 1.5s ease-in-out infinite;
  }

  @keyframes heartbeat {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.15); }
  }

  .animate-sequence-row-in {
    animation: sequence-row-in 280ms cubic-bezier(0.22, 1, 0.36, 1) both;
    will-change: transform, opacity;
  }

  @keyframes sequence-row-in {
    from {
      opacity: 0;
      transform: translateY(8px) scale(0.995);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .animate-overlay-in {
    animation: overlay-in 180ms ease-out both;
  }

  @keyframes overlay-in {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .animate-overlay-out {
    animation: overlay-out 220ms ease-in both;
    will-change: opacity;
  }

  @keyframes overlay-out {
    from { opacity: 1; }
    to { opacity: 0; }
  }

  .animate-modal-in {
    animation: modal-in 240ms cubic-bezier(0.22, 1, 0.36, 1) both;
    transform-origin: center top;
    will-change: transform, opacity;
  }

  @keyframes modal-in {
    from {
      opacity: 0;
      transform: translateY(10px) scale(0.98);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .animate-modal-out {
    animation: modal-out 220ms cubic-bezier(0.4, 0, 1, 1) both;
    transform-origin: center top;
    will-change: transform, opacity;
  }

  @keyframes modal-out {
    from {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
    to {
      opacity: 0;
      transform: translateY(8px) scale(0.985);
    }
  }

  .animate-dropdown-pop {
    animation: dropdown-pop 200ms cubic-bezier(0.22, 1, 0.36, 1) both;
    transform-origin: var(--radix-select-content-transform-origin, top center);
    will-change: transform, opacity;
  }

  @keyframes dropdown-pop {
    from {
      opacity: 0;
      transform: translateY(-4px) scale(0.98);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .animate-language-toggle-label {
    animation: language-toggle-label 180ms ease-out both;
    will-change: transform, opacity;
  }

  @keyframes language-toggle-label {
    from {
      opacity: 0;
      transform: translateY(6px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .animate-compare-page-enter {
    animation: compare-page-enter 240ms cubic-bezier(0.22, 1, 0.36, 1) both;
    will-change: transform, opacity;
  }

  @keyframes compare-page-enter {
    from {
      opacity: 0;
      transform: translateY(8px) scale(0.996);
    }
    to {
      opacity: 1;
      transform: translateY(0) scale(1);
    }
  }

  .generation-widget-card {
    transition: background-color 200ms ease, border-color 200ms ease, box-shadow 200ms ease;
  }

  @keyframes generation-widget-in {
    from {
      opacity: 0;
      transform: translateX(16px) translateY(6px) scale(0.985);
    }
    to {
      opacity: 1;
      transform: translateX(0) translateY(0) scale(1);
    }
  }

  .generation-widget-card--regenerate {
    box-shadow:
      0 14px 34px rgba(251, 146, 60, 0.18),
      0 2px 10px rgba(251, 146, 60, 0.12);
  }

  .generation-widget-item {
    animation: generation-widget-in 220ms cubic-bezier(0.22, 1, 0.36, 1) both;
    transform-origin: bottom right;
    display: block;
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
    margin-bottom: 0.375rem;
    transition:
      opacity 220ms ease-out,
      transform 220ms cubic-bezier(0.22, 1, 0.36, 1);
    will-change: opacity, transform;
    backface-visibility: hidden;
  }

  .generation-widget-item > * {
    min-height: 0;
    overflow: hidden;
  }

  .generation-widget-item:last-child {
    margin-bottom: 0;
  }

  .generation-widget-item--exit {
    animation: none;
    opacity: 0;
    transform: translate3d(16px, 0, 0) scale(0.985);
  }

  .generation-widget-progress-fill {
    position: relative;
    overflow: hidden;
    transition: width 420ms cubic-bezier(0.22, 1, 0.36, 1);
  }

  .generation-widget-progress-fill::after {
    content: none;
  }

  @keyframes generation-progress-glint {
    to {
      transform: translateX(120%);
    }
  }

  .generation-widget-status-text {
    opacity: 1;
  }

  .generation-widget-body-inner {
    min-height: 0;
    overflow: hidden;
  }

  .generation-widget-progress-wrap {
    display: grid;
    transition: grid-template-rows 260ms cubic-bezier(0.22, 1, 0.36, 1), opacity 200ms ease-out;
  }

  .generation-widget-progress-wrap--open {
    grid-template-rows: 1fr;
    opacity: 1;
  }

  .generation-widget-progress-wrap--closed {
    grid-template-rows: 0fr;
    opacity: 0;
  }

  .generation-widget-progress-wrap-inner {
    min-height: 0;
    overflow: hidden;
  }

  /* Reduced motion preference - disable animations for users who prefer reduced motion */
  @media (prefers-reduced-motion: reduce) {
    *,
    *::before,
    *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
    }

    /* Remove will-change hints when animations are disabled */
    .animate-fade-in {
      will-change: auto !important;
    }

    .animate-fade-in,
    .animate-shimmer,
    .animate-spin,
    .animate-ping,
    .animate-pulse,
    .animate-pulse-subtle,
    .animate-heartbeat,
    .animate-sequence-row-in,
    .animate-overlay-in,
    .animate-overlay-out,
    .animate-modal-in,
    .animate-modal-out,
    .animate-dropdown-pop,
    .animate-language-toggle-label,
    .animate-compare-page-enter,
    .animate-sequence-header-view-in,
    .animate-sequence-header-edit-in,
    .animate-sequence-header-actions-in,
    .generation-widget-card,
    .generation-widget-item,
    .generation-widget-progress-fill::after,
    .generation-widget-status-text {
      animation: none !important;
    }

    .generation-widget-item,
    .generation-widget-progress-wrap {
      transition: none !important;
    }
  }
}

::view-transition-old(root),
::view-transition-new(root),
::view-transition-group(root) {
  animation: none !important;
}
